<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="winwin.dao.NoticeBoardDao">
 	<select id="totalCnt" resultType="int">
 		SELECT count(*)
 		FROM notice 	
 	</select>
 	<select id="list" parameterType="winwin.util.Paging" resultType="winwin.dto.NoticeBoard">
 		SELECT
 			B.rnum,
 			B.noticeno,
 			B.title,
 			B.code,
 			B.writer,
 			B.content,
 			B.hit,
 			B.writedate		
 		FROM(
 			SELECT rownum rnum, A.*
 			FROM(
 				SELECT * FROM notice
 				ORDER BY noticeno DESC
 			)A 
 			ORDER BY rnum
 		)B
 		WHERE B.rnum BETWEEN #{startNo} AND #{endNo}
 	</select>
 	<update id="hit" parameterType="winwin.dto.NoticeBoard">
 		UPDATE notice SET hit = hit+1
 		WHERE noticeno = #{noticeno}
 	</update>
 	<select id="view" parameterType="winwin.dto.NoticeBoard" resultType="winwin.dto.NoticeBoard">
 		SELECT
 			noticeno,
 			title,
 			code,
 			writer,
 			content,
 			hit,
 			writedate
 		FROM notice
 		WHERE noticeno = #{noticeno} 	
 	</select>
 	<select id="filesByBoardNo" parameterType="winwin.dto.NoticeBoard" resultType="winwin.dto.Material">
 		SELECT
 			fileNo,
 			userId,
 			adminCode,
 			noticeNo,
 			portfolioId,
 			originName,
 			storedName,
 			writedate,
 			filesize,
 			path
 		FROM material
 		WHERE noticeno = #{noticeno}
 	</select>
 	<insert id="write" parameterType="winwin.dto.NoticeBoard">
 		INSERT INTO
 			notice
 		VALUES
 			(
 			notice_seq.nextval,
 			#{title},
 			#{code},
 			#{writer},
 			#{content},
 			default,
 			default
 			)
 	</insert>
 	<insert id="insertFile" parameterType="winwin.dto.Material">
 		INSERT INTO
 			material	
 		VALUES
 			(
 			material_seq.nextval,
 			#{userId},
 			#{adminCode},
 			#{noticeNo},
 			null,
 			#{originName},
 			#{storedName},
 			default,
 			#{fileSize},
 			#{path}
 			)
 	</insert>
 </mapper>